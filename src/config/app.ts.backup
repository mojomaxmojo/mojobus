/**
 * App-Konfiguration für MojoBus Blog
 * Zentrale Verwaltung aller App-Einstellungen für manuelle Anpassungen
 */

import { type Theme } from '@/contexts/AppContext';
import { RELAY_PRESETS } from './relays';

// ============================================================================
// THEME-KONFIGURATION
// ============================================================================

export const THEME_CONFIG = {
  // Verfügbare Themes
  themes: ['light', 'dark', 'system'] as const,

  // Default Theme
  defaultTheme: 'light' as Theme,

  // Theme-Persistenz
  persist: true,
  storageKey: 'nostr:theme',
} as const;

// ============================================================================
// NOSTR-KONFIGURATION
// ============================================================================

export const NOSTR_CONFIG = {
  // Event Kinds
  kinds: {
    note: 1,          // Short notes
    longform: 30023,  // Long-form articles (NIP-23)
    metadata: 0,      // Profile metadata
    comment: 1111,    // Comments (NIP-22)
    replaceable: 30000, // Replaceable events
    parameterizedReplaceable: 30001, // Parameterized replaceable events
  },

  // Cache settings - optimiert für Performance
  cache: {
    maxAge: 1000 * 60 * 60, // 1 hour
    staleTime: 1000 * 60 * 10, // 10 minutes (erhöht für bessere Performance)
  },

  // Query timeouts (in milliseconds)
  timeouts: {
    default: 2000,
    fast: 1500,
    normal: 3000,
    slow: 5000,
  },
} as const;

// ============================================================================
// APP-PRESETS (Vorkonfigurierte Profile)
// ============================================================================

export const APP_PRESETS = {
  // Performance-optimiert (schnelleste Ladezeiten)
  performance: {
    name: 'Performance',
    description: 'Maximale Performance mit minimalem Latency',
    theme: 'light' as Theme,
    relayUrls: RELAY_PRESETS.fast.relayUrls,
    activeRelay: RELAY_PRESETS.fast.relayUrls[0],
    maxRelays: RELAY_PRESETS.fast.maxRelays,
    enableDeduplication: true,
    queryTimeout: RELAY_PRESETS.fast.queryTimeout,
  },

  // Standard (ausgewogene Konfiguration)
  standard: {
    name: 'Standard',
    description: 'Ausgewogene Konfiguration für gute Performance und Zuverlässigkeit',
    theme: 'light' as Theme,
    relayUrls: RELAY_PRESETS.balanced.relayUrls,
    activeRelay: RELAY_PRESETS.balanced.relayUrls[0],
    maxRelays: RELAY_PRESETS.balanced.maxRelays,
    enableDeduplication: true,
    queryTimeout: RELAY_PRESETS.balanced.queryTimeout,
  },

  // Reliable (maximale Zuverlässigkeit)
  reliable: {
    name: 'Reliable',
    description: 'Maximale Zuverlässigkeit mit mehreren Relays',
    theme: 'light' as Theme,
    relayUrls: RELAY_PRESETS.reliable.relayUrls,
    activeRelay: RELAY_PRESETS.reliable.relayUrls[0],
    maxRelays: RELAY_PRESETS.reliable.maxRelays,
    enableDeduplication: true,
    queryTimeout: RELAY_PRESETS.reliable.queryTimeout,
  },

  // Dark Mode (für Nachtansicht)
  dark: {
    name: 'Dark Mode',
    description: 'Dunkles Theme für komfortables Lesen bei Nacht',
    theme: 'dark' as Theme,
    relayUrls: RELAY_PRESETS.fast.relayUrls,
    activeRelay: RELAY_PRESETS.fast.relayUrls[0],
    maxRelays: RELAY_PRESETS.fast.maxRelays,
    enableDeduplication: true,
    queryTimeout: RELAY_PRESETS.fast.queryTimeout,
  },
} as const;

// ============================================================================
// DEFAULT APP-KONFIGURATION
// ============================================================================

/**
 * Default Konfiguration für MojoBus Blog
 * Kann durch localStorage überschrieben werden
 *
 * ÄNDERUNGEN HIER:
 * - relayUrls: Liste der Relays, die für Queries verwendet werden
 * - activeRelay: Relay für das Publishen (aus relayUrls)
 * - maxRelays: Max. Anzahl an Relays für Queries (1 = nur ein Relay)
 * - queryTimeout: Timeout in Millisekunden für Queries
 */
export const DEFAULT_APP_CONFIG = {
  // Theme-Einstellung
  theme: THEME_CONFIG.defaultTheme,

  // Relay-Einstellungen (Performance-optimiert)
  relayUrls: RELAY_PRESETS.fast.relayUrls, // Nur ein schneller Relay für maximale Performance
  activeRelay: RELAY_PRESETS.fast.relayUrls[0], // Erster Relay wird für Publishing verwendet

  // Relay-Performance-Optionen
  maxRelays: RELAY_PRESETS.fast.maxRelays, // Nur einen Relay verwenden
  enableDeduplication: true, // Deduplizierung von Events aktivieren
  queryTimeout: RELAY_PRESETS.fast.queryTimeout, // Timeout in ms
} as const;

// ============================================================================
// APP-SETTINGS (Persistente Einstellungen)
// ============================================================================

export const APP_SETTINGS = {
  // Storage Key für localStorage
  storageKey: 'nostr:app-config',

  // Login Storage Key
  loginStorageKey: 'nostr:login',

  // Auto-refresh settings
  autoRefresh: {
    enabled: false,
    interval: 60000, // 1 minute
  },

  // UI settings
  ui: {
    infiniteScroll: true,
    showTimestamps: true,
    showReactions: true,
    showZaps: true,
  },

  // Performance settings
  performance: {
    preloadImages: true,
    lazyLoad: true,
    cacheEnabled: true,
  },
} as const;

// ============================================================================
// VALIDATION-KONSTANTEN
// ============================================================================

export const CONFIG_LIMITS = {
  relayUrls: {
    min: 1,
    max: 10,
  },
  maxRelays: {
    min: 1,
    max: 10,
  },
  queryTimeout: {
    min: 1000, // 1 second
    max: 30000, // 30 seconds
  },
} as const;

// ============================================================================
// EXPORTS
// ============================================================================

export default DEFAULT_APP_CONFIG;
